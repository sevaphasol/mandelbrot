# Mandelbrot

## Описание

Множество Мандельброта — это фрактал, определяемый как множество точек на комплексной плоскости, для которых итеративная последовательность не выходит за определенные границы. Проект демонстрирует ускорение вычислений за счет использования SIMD-инструкций (SSE, AVX2, AVX512).

## Реализации

Доступны следующие варианты вычисления множества Мандельброта:

1. **NORMAL** – базовая реализация без оптимизаций.
2. **SSE**    – оптимизация с использованием SSE-инструкций    (128-битные векторы).
3. **AVX2**   – оптимизация с использованием AVX2-инструкций   (256-битные векторы).
4. **AVX512** – оптимизация с использованием AVX512-инструкций (512-битные векторы).

## Требования

- Поддержка AVX512.
- Графическая библиотека SFML для визуализации.
- gnuplot для посторения графиков в режиме тестирования.

## Сборка и запуск

```bash
make
bin/mandelbrot [опции]
```

### Поддерживаемые опции

| Опция              | Описание                                                                 |
|--------------------|--------------------------------------------------------------------------|
| `--help`, `-h`     | Выводит сообщение с описанием всех доступных опций.                      |
| `--stats`, `-s`    | Показывает статистику в графическом режиме.                              |
| `--plot`, `-p`     | Включает построение графика.                                             |
| `--Pulsation`, `-P`| Включает анимацию (пульсация) изображения.                               |
| `--graphics`, `-t` | Графический режим (с визуализацией). Режим по умолчанию.                 |
| `--benchmark`, `-t`| При включенном -s выводит только статистику (без визуализации).          |
| `--testing`, `-t`  | Режим тестирования программы. Считаем время исполнения по МНК.           |
| `--mode=<number>`  | Устанавливает режим работы программы:                                    |
|                    | `0` — graphics mode                                                      |
|                    | `1` — testing mode                                                       |
|                    | `2` — benchmark mode                                                     |
| `--alpha<number>`  | Устанавливает значение альфа (прозрачность пикселей).                    |
| `--runs=<number>`  | Устанавливает количество запусков в тестовом режиме.                     |
| `--calc=<number>`  | Устанавливает режим вычислений:                                          |
|                    | `0` — NORMAL                                                             |
|                    | `1` — SSE                                                                |
|                    | `2` — AVX2                                                               |
|                    | `3` — AVX-512                                                            |

## Примеры работы программы

### Graphics mode

![output](https://github.com/user-attachments/assets/09976a63-0fb6-4806-a52a-49d694228eb5)

### Testing mode

![output](https://github.com/user-attachments/assets/6ebb8da7-a150-4316-9dc8-6594c8ea948d)

### Benchmark mode

![output](https://github.com/user-attachments/assets/dea49850-dc46-4c69-adab-58b865e0c64d)

fps — частота обновления кадров

time — время обновления кадра

freq — текущая тактовая частота процессора

frames — количество обработанных кадров

spikes — количество кадров с просадками

## Измерение работы программы с различными оптимизациями

Программа была запущена в **testing mode**.

Получена зависимость количества тактов процессора, за которые вычисляется множество Мандельброта,
от количества повторений вычисления.

С помощью методов наименьших квадратов (МНК) был получен коэффициент наклона экспериментальной прямой — slope, а
также смещение прямой - intercept.

slope отвечает за среднее время работы основной части вычислений множества Мандельброта.

intercept отвечает за среднее время работы "накладных расходов" — инициализация переменных перед основым циклом вычислений.

С помощью того же метода МНК были получены погрешности для обоих величин.

### NORMAL

![_NORMAL (63 7+-0 7) (3 6+-1 0)](https://github.com/user-attachments/assets/0598e456-5bc1-4d45-9051-be841205e4ba)

slope =     (63.7 ± 0.7) ms

intercept = (3.6  ± 1.0) ms

### SSE

![_SSE (34 1+-0 2) (2 0+-0 3)](https://github.com/user-attachments/assets/d88847b0-d179-456e-b0c3-cd4abf1321cc)

slope =     (34.1 ± 0.2) ms

intercept = (2.0  ± 0.3) ms

### AVX2

![_AVX2 (17 8+-0 3) (1 1 +- 0 4)](https://github.com/user-attachments/assets/59e19087-5f57-4682-90c2-a61b78e3116f)

slope =     (17.8 ± 0.3) ms

intercept = (1.1  ± 0.4) ms

### AVX512

![_AVX512 (11 9+-0 3) (1 1+-0 5)](https://github.com/user-attachments/assets/7e6f15bc-9cae-489e-961f-3582398650ab)

slope =     (11.9 ± 0.3) ms

intercept = (1.1  ± 0.5) ms

## Обсуждение результатов
Теоретически время работы различных реализаций должно быть в соотношении 8:4:2:1 (NORMAL:SSE:AVX2:AVX512),
т.к. каждая оптимизация обрабатывает вдвое большую порцию данных за раз.
Экспериментально мы подтвердили это.

## Предложения по улучшению проекта
Добавить ещё одну оптимизацию вычислений - в GPU.
GPU может обрабатывать очень большие вектора, что значительно ускорит вычисление множества Мандельброта.

